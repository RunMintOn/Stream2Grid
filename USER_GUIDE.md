# WebCanvas 用户使用指南

> **版本**: 1.0.0  
> **构建日期**: 2026-01-14  
> **项目**: WebCanvas (Obsidian Browser Scout)

---

## 🚀 快速开始

### 第一步：加载扩展

#### 方法 1：开发者模式（推荐用于测试）

1. 打开 Chrome 或 Edge 浏览器
2. 在地址栏输入 `chrome://extensions/`
3. 开启右上角的"开发者模式"开关
4. 点击"加载已解压的扩展程序"
5. 选择项目目录：
   ```
   D:\11_myProject\12canvas_BroswerPlugin\dist
   ```
6. 点击"加载"按钮
7. 扩展图标会出现在浏览器工具栏中（蓝色方块图标）

#### 方法 2：打包安装

```bash
cd dist
# 将 dist 目录打包为 zip
# 然后拖拽到 chrome://extensions/ 页面安装
```

---

## 📖 功能说明

### 1. 项目管理

#### 创建新画板

1. 打开扩展 Side Panel
2. 确保在"项目列表"视图
3. 点击"+ 新建画板"按钮
4. 输入画板名称（如"装修灵感"）
5. 点击"创建"或按 Enter 键

#### 查看项目列表

- Side Panel 显示所有已创建的画板
- 每个项目卡片显示：
  - 画板名称
  - 最后更新时间
  - 删除按钮（右上角）

#### 删除画板

1. 鼠标悬停在项目卡片上
2. 点击右上角的"×"删除按钮
3. 确认对话框提示"确定要删除这个画板吗？所有卡片也会被删除"
4. 点击"确定"后，项目和所有关联的卡片被删除

#### 进入卡片视图

1. 点击任意项目卡片
2. Side Panel 切换到"卡片视图"
3. 顶部导航栏显示当前项目名称

---

### 2. 内容采集

#### 支持的内容类型

| 类型 | 采集方式 | 显示效果 |
|------|---------|---------|
| **文本** | 选中网页文字 → 拖拽到侧边栏 | 文本卡片 |
| **图片** | 拖拽图片到侧边栏 | 图片卡片（自动下载） |
| **链接** | 拖拽链接或 URL 到侧边栏 | 链接卡片 |

#### 文本采集

1. 在任意网页（如 Wikipedia、知乎）中
2. 用鼠标选中一段文字
3. 拖拽到扩展侧边栏
4. 松开鼠标后，文本卡片自动创建

#### 图片采集

1. 在任意网页中找到图片
2. 直接拖拽图片到侧边栏
3. 扩展会：
   - 自动下载图片（通过 Background Service Worker）
   - 显示"下载中..."加载态
   - 下载完成后显示图片卡片

**注意**：
- 如果图片下载失败，会显示"加载失败"错误态
- 支持跨域图片下载
- 图片以 Blob 形式存储在 IndexedDB 中

#### 链接采集

1. 在任意网页中拖拽链接（<a> 标签或地址栏 URL）
2. 扩展会自动：
   - 提取链接信息
   - 获取网站 Favicon
   - 创建链接卡片

#### 直接文件拖拽

1. 从本地文件夹拖拽图片文件到侧边栏
2. 扩展会直接处理图片文件并创建卡片

---

### 3. 卡片管理

#### 查看卡片

- 进入任意项目后，所有卡片以垂直列表形式显示
- 列表按采集顺序排列

#### 文本卡片

**显示内容**：
- 最多显示 4 行文字（超出部分被截断）
- 显示来源网站的 Favicon 和域名（可点击跳转）

**交互**：
- 如果文字超过 4 行或 300 字符，显示"展开全部"按钮
- 点击"展开全部"显示完整文本
- 悬停卡片显示右上角"×"删除按钮

#### 图片卡片

**显示内容**：
- 图片缩略图（最大高度 180px，自动裁剪）
- 图片文件名
- 来源网站的 Favicon 和域名（可点击跳转）

**交互**：
- 显示加载态（灰色闪烁动画）
- 显示错误态（如果下载失败）
- 悬停卡片显示右上角"×"删除按钮

#### 链接卡片

**显示内容**：
- 网站 Favicon
- 链接标题
- 域名（可点击跳转到原链接）

**交互**：
- 点击卡片跳转到原链接
- 悬停卡片显示右上角"×"删除按钮

---

### 4. 删除与撤销

#### 删除卡片

1. 悬停在任意卡片上
2. 点击右上角的"×"删除按钮
3. 卡片立即消失
4. 底部显示 Toast 提示："已删除 1 个项目 (撤销)"

#### 撤销删除

1. 在 Toast 提示消失前（3 秒内）点击"撤销"按钮
2. 删除的卡片立即恢复
3. Toast 自动消失

---

### 5. 导出到 Obsidian Canvas

#### 导出流程

1. 确保在"卡片视图"（显示当前项目名称）
2. 点击顶部导航栏右侧的"导出"按钮
3. 浏览器自动下载文件：`[项目名].zip`

#### ZIP 文件内容

下载的 `.zip` 文件包含：

```
[项目名].zip
├── [项目名].canvas           # Obsidian Canvas JSON 文件
└── attachments/                 # 附件文件夹
    ├── image-xxx.png         # 所有采集的图片
    ├── image-yyy.png
    └── ...
```

#### 在 Obsidian 中使用

1. 打开 Obsidian（版本 1.0+，支持 Canvas）
2. 解压下载的 `.zip` 文件
3. 将 `[项目名].canvas` 文件放入 Obsidian vault
4. 点击 `.canvas` 文件

**显示效果**：
- 所有卡片按 4 列网格布局自动排列
- 文本节点显示文本内容
- 图片节点显示图片（相对路径 `attachments/image-xxx.png`）
- 链接节点显示 URL（点击可跳转）

**注意**：
- 导出后可以在 Obsidian 中自由编辑
- 可以添加新节点、连线、分组等
- 不会影响扩展中的数据（导出是单向的）

---

## 🎯 使用场景示例

### 场景 1：装修灵感收集

1. **新建项目**：命名为"客厅设计"
2. **收集文本**：浏览装修网站，拖拽设计理念文字
3. **收集图片**：拖拽喜欢的家具图片
4. **收集链接**：拖拽电商网站商品链接
5. **整理**：在列表中删除不需要的卡片
6. **导出**：点击"导出"按钮
7. **在 Obsidian 中整理**：导入后拖拽节点进行布局调整

### 场景 2：技术调研

1. **新建项目**：命名为"前端框架对比"
2. **收集资料**：从技术文档、博客拖拽代码片段和架构图
3. **添加标签**：使用链接卡片保存参考资料链接
4. **导出**：导出为 Canvas
5. **二次整理**：在 Obsidian 中添加连线表示技术关系

### 场景 3：学习笔记

1. **新建项目**：命名为"机器学习笔记"
2. **收集概念**：从教程网站拖拽关键概念文本
3. **保存图片**：拖拽公式、图表截图
4. **导出复习**：导出为 Canvas 用于复习

---

## ⚙️ 技术细节

### 数据存储

- **存储位置**：浏览器 IndexedDB
- **库名称**：`WebCanvasDB`
- **容量**：受浏览器限制（通常数百 MB）
- **特点**：完全本地存储，无需网络，隐私优先

### 数据安全

- ✅ 所有数据存储在本地（IndexedDB）
- ✅ 不会上传到任何服务器
- ✅ 导出后，数据仍在扩展中（双向独立）

### 浏览器兼容性

| 浏览器 | 版本要求 | 状态 |
|---------|---------|------|
| Chrome | >= 120 | ✅ 支持 |
| Edge | >= 120 | ✅ 支持 |
| Firefox | - | ❌ 暂不支持 |
| Safari | - | ❌ 暂不支持 |

### Obsidian 兼容性

| 功能 | 要求 | 状态 |
|------|------|------|
| Obsidian Canvas 插件 | >= 1.0 | ✅ 支持 |
| JSON Canvas 格式 | 符合 [jsoncanvas.org/spec/1.0/](https://jsoncanvas.org/spec/1.0/) | ✅ 兼容 |

---

## 🔍 调试与故障排查

### 查看日志

#### Side Panel 日志
1. 右键 Side Panel 内容
2. 点击"检查" → Side Panel DevTools
3. 在 Console 标签中查看 `[WebCanvas]` 前缀的日志

#### Background Service Worker 日志
1. 访问 `chrome://extensions/`
2. 在对应扩展卡片右侧点击"service worker"链接
3. 查看后台处理日志

#### Content Script 日志
1. 在任意网页按 F12 打开 DevTools
2. 在 Console 中查看 `[WebCanvas]` 日志

### 常见问题

#### 问题：Side Panel 无法打开

**可能原因**：
- 扩展未正确加载
- 浏览器版本不支持

**解决方法**：
1. 重新加载扩展（chrome://extensions/ → 刷新）
2. 检查浏览器版本

#### 问题：拖拽后没有创建卡片

**可能原因**：
- Content Script 未正确注入
- 网页刷新后才能生效

**解决方法**：
1. 刷新网页
2. 重新尝试拖拽

#### 问题：图片下载失败

**可能原因**：
- 图片服务器防盗链
- 网络连接问题

**解决方法**：
1. 等待几秒后重试
2. 或者直接拖拽图片文件

#### 问题：导出后 Obsidian 中图片不显示

**可能原因**：
- 图片格式不支持
- 文件路径错误

**解决方法**：
1. 检查 ZIP 文件是否正确解压
2. 确保 attachments 文件夹和 .canvas 文件在同一目录

---

## 📝 键盘快捷键

| 快捷键 | 功能 |
|---------|------|
| **Enter** | 创建画板（在输入框中） |
| **Esc** | 取消创建画板 |

**注意**：拖拽排序功能未在 MVP 中实现，暂无快捷键。

---

## 🎨 自定义选项

### 当前状态

扩展当前提供**固定的 UI 样式**，暂不支持主题自定义。

### 未来计划

可能在未来版本中添加：
- 主题切换（浅色/深色模式）
- 自定义卡片尺寸
- 自定义网格列数

---

## 📚 参考资源

### 官方文档

- [Obsidian Canvas 文档](https://help.obsidian.md/plugins/canvas)
- [JSON Canvas 规范](https://jsoncanvas.org/spec/1.0/)
- [Chrome Extension 文档](https://developer.chrome.com/docs/extensions/mv3/)

### 技术栈文档

- [React 官方文档](https://react.dev/)
- [Dexie.js 文档](https://dexie.org/)
- [Tailwind CSS 文档](https://tailwindcss.com/)
- [CRXJS 文档](https://crxjs.dev/vite-plugin)

---

## 💡 使用建议

1. **先测试基本功能**：在简单的网页上测试拖拽采集
2. **定期导出**：养成定期导出备份的习惯
3. **善用删除功能**：及时清理不需要的卡片
4. **检查导出**：在 Obsidian 中检查导出的内容是否正确
5. **反馈问题**：遇到问题时，请提供详细的复现步骤

---

## 📧 卸载

### 完全移除扩展

1. 访问 `chrome://extensions/`
2. 找到 "WebCanvas" 扩展
3. 点击"移除"按钮

### 数据清理

卸载扩展后：
- IndexedDB 数据会被浏览器自动清理
- 无需手动操作

---

**祝使用愉快！** 🎉

如有任何问题或建议，欢迎反馈！
